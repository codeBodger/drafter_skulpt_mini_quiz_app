<!DOCTYPE html>
<html>
    <head>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt.js" type="text/javascript"></script>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt-stdlib.js" type="text/javascript"></script>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt-drafter.js" type="text/javascript"></script>
        <script
            src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"
        ></script>
        <script type="text/javascript">
            let pythonSource = {};
            pythonSource['main.py'] = '#!/bin/python\n\nfrom typing import Any\nfrom drafter import Div, TextBox, route, Page, Button, start_server, __version__, deploy_site, get_main_server\nfrom dataclasses import dataclass\n\nfrom random import randint\n\n@dataclass\nclass Term:\n        term: str\n        definition: str\n\n@dataclass\nclass State:\n        terms: list[Term]\n\n@route\ndef index(state: State) -> Page:\n        return Page(state, [\n                "What do you want to do?",\n                Button("Add Terms", add_terms),\n                Button("Study", study)\n        ])\n\n@route\ndef add_terms(state: State) -> Page:\n        term_entry_boxes = [term_entry_box(term, i) for i, term in enumerate(state.terms)]\n        return Page(state, [\n                "Enter terms below:",\n                *term_entry_boxes,\n                Button("+", add_term_entry_pannel),\n                Button("Save", save_entered_terms)\n        ])\n\ndef term_entry_box(term: Term, key: int) -> Div:\n        return Div(\n                "Term:", TextBox(f"term{key}", term.term),\n                "Definition:", TextBox(f"definition{key}", term.definition)\n        )\n\n@route\ndef add_term_entry_pannel(state: State) -> Page:\n        state.terms.append(Term("", ""))\n        return add_terms(state)\n\n@route\ndef save_entered_terms(state: State, *args: Any, **kwargs: str) -> Page:\n        print(args, kwargs)\n        state.terms.clear()\n        while len(kwargs):\n                val = kwargs.popitem()\n                key = val[0]\n                if key.startswith("term"):\n                        term = val[1]\n                        def_key = key.replace("term", "definition")\n                        definition = kwargs.pop(def_key)\n                elif key.startswith("definition"):\n                        definition = val[1]\n                        term_key = key.replace("definition", "term")\n                        term = kwargs.pop(term_key)\n                else: continue\n\n                state.terms.append(Term(term, definition))\n        return index(state)\n\n@route\ndef study(state: State) -> Page:\n        raise NotImplementedError()\n\nprint(__version__)\n\ndeploy_site()\n\nget_main_server().configuration.cdn_skulpt = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt.js"\nget_main_server().configuration.cdn_skulpt_std = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt-stdlib.js"\nget_main_server().configuration.cdn_skulpt_drafter = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt-drafter.js"\nget_main_server().configuration.cdn_drafter_setup = "https://codebodger.github.io/drafter/cdn/skulpt/drafter-setup.js"\n\n# get_main_server().configuration.cdn_skulpt = "http://localhost:8080/skulpt.js"\n# get_main_server().configuration.cdn_skulpt_std = "http://localhost:8080/skulpt-stdlib.js"\n# get_main_server().configuration.cdn_skulpt_drafter = "http://localhost:8080/skulpt-drafter.js"\n# get_main_server().configuration.cdn_drafter_setup = "http://localhost:8080/drafter-setup.js"\n\nv = __version__.split(".")\n\nif int(v[0]) == 2 and int(v[1]) == 0:\n        start_server(State(list[Term]()))\n';

            function compilePython() {
                for (let fileName in pythonSource) {
                    let internalName = fileName.replace(/\.py$/, ".js");
                    let contents = pythonSource[fileName];
                    let co = Sk.compile(contents, `src/student/${fileName}`, 'exec', true, true);
                    Sk.builtinFiles.files[`src/student/${internalName}`] = `${co.code}\nvar $builtinmodule = ${co.funcname};`;
                }
            }

            Sk.output = console.log;
        </script>
    </head>

    <body>
        <div id="website">
            Loading...
        </div>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/drafter-setup.js" type="text/javascript"></script>
    </body>
</html>
