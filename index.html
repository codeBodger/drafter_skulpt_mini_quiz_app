<!DOCTYPE html>
<html>
    <head>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt.js" type="text/javascript"></script>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt-stdlib.js" type="text/javascript"></script>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt-drafter.js" type="text/javascript"></script>
        <script
            src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"
        ></script>
        <script type="text/javascript">
            let pythonSource = {};
            pythonSource['main.py'] = '#!/bin/python\n\nfrom drafter import route, Page, Button, start_server, __version__, deploy_site, get_main_server, Table\nfrom dataclasses import dataclass\n\nfrom random import randint\n\n@dataclass\nclass State:\n        counter: int\n\n@route\ndef index(state: State) -> Page:\n        return Page(state, [Table([\n                ["Welcome to Drafter!",\n                "Click the button below."],\n                [Button("Increase the count", increment_counter, (randint(1,100),))],\n        ])])\n\n@route\ndef increment_counter(state: State, offset: int) -> Page:\n        raise ValueError("aa")\n        state.counter += offset\n        return Page(state, [\n                "You\'ve clicked the button " + str(state.counter) + " times",\n                Button("Click again", increment_counter, (randint(1,100),))\n        ])\n\nprint(__version__)\n\ndeploy_site()\n\nget_main_server().configuration.cdn_skulpt = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt.js"\nget_main_server().configuration.cdn_skulpt_std = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt-stdlib.js"\nget_main_server().configuration.cdn_skulpt_drafter = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt-drafter.js"\nget_main_server().configuration.cdn_drafter_setup = "https://codebodger.github.io/drafter/cdn/skulpt/drafter-setup.js"\n\nv = __version__.split(".")\n\nif int(v[0]) == 2 and int(v[1]) == 0:\n        start_server(State(0))\n';

            function compilePython() {
                for (let fileName in pythonSource) {
                    let internalName = fileName.replace(/\.py$/, ".js");
                    let contents = pythonSource[fileName];
                    let co = Sk.compile(contents, `src/student/${fileName}`, 'exec', true, true);
                    Sk.builtinFiles.files[`src/student/${internalName}`] = `${co.code}\nvar $builtinmodule = ${co.funcname};`;
                }
            }

            Sk.output = console.log;
        </script>
    </head>

    <body>
        <div id="website">
            Loading...
        </div>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/drafter-setup.js" type="text/javascript"></script>
    </body>
</html>
