<!DOCTYPE html>
<html>
    <head>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt.js" type="text/javascript"></script>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt-stdlib.js" type="text/javascript"></script>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/skulpt-drafter.js" type="text/javascript"></script>
        <script
            src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"
        ></script>
        <script type="text/javascript">
            let pythonSource = {};
            pythonSource['main.py'] = '#!/bin/python\n\nfrom drafter import Div, LineBreak, Text, TextBox, route, Page, Button, start_server, __version__, deploy_site, get_main_server\nfrom dataclasses import dataclass\n\nfrom random import choice\n\n@dataclass\nclass Term:\n        term: str\n        definition: str\n        you_said: str = ""\n\n@dataclass\nclass State:\n        terms: list[Term]\n\n@route\ndef index(state: State) -> Page:\n        return Page(state, [\n                "What do you want to do?",\n                Button("Add/Edit Terms", edit_terms),\n                Button("Study Terms", study),\n                Button("Last Run Results", generate_report)\n        ])\n\n@route\ndef edit_terms(state: State) -> Page:\n        term_entry_boxes: list[Div] = []\n        for i, term in enumerate(state.terms):\n                term_entry_boxes.append(term_entry_box(term, i))\n\n        return Page(state, [\n                "Enter terms below:",\n                *term_entry_boxes,\n                Button("+", save_entered_terms, ("add_term_entry_box", len(term_entry_boxes))),\n                Button("Main Menu", save_entered_terms, ("index", len(term_entry_boxes)))\n        ])\n\ndef term_entry_box(term: Term, key: int) -> Div:\n        return Div(\n                "Term: ", TextBox(f"term{key}", term.term), "&nbsp;&nbsp;&nbsp; "\n                "Definition: ", TextBox(f"definition{key}", term.definition)\n        )\n\n@route\ndef add_term_entry_box(state: State) -> Page:\n        state.terms.append(Term("", ""))\n        return edit_terms(state)\n\n@route\ndef save_entered_terms(state: State, procede_to: str, entry_len: int, **kwargs: str) -> Page:\n        state.terms.clear()\n        for i in range(entry_len):\n                term = kwargs.pop(f"term{i}")\n                definition = kwargs.pop(f"definition{i}")\n                state.terms.append(Term(term, definition))\n\n        if procede_to == "add_term_entry_box":\n                return add_term_entry_box(state)\n        elif procede_to == "index":\n                return index(state)\n        return index(state)\n\n@route\ndef study(state: State) -> Page:\n        unvisited_terms: list[Term] = []\n        for term in state.terms:\n                if not term.you_said: unvisited_terms.append(term)\n        if not unvisited_terms:\n                return generate_report(state)\n        rand_term = choice(unvisited_terms)\n        return Page(state, [\n                f"Term: {rand_term.term}",\n                Text("Definition:"), TextBox("term_answer"), LineBreak(),\n                Button("Submit", store_answer, ("study",), kwargs={"term_name": rand_term.term}),\n                Button("See Results Now", store_answer, ("generate_report",), kwargs={"term_name": rand_term.term})\n        ])\n\n@route\ndef store_answer(state: State, procede_to: str, term_name: str = "", term_answer: str = "") -> Page:\n        term = None\n        for t in state.terms:\n                if t.term == term_name:\n                        term = t\n                        break\n        if term:\n                term.you_said = term_answer\n\n        if procede_to == "generate_report":\n                return generate_report(state)\n        return study(state)\n\n@route\ndef generate_report(state: State) -> Page:\n        visited_terms: list[Term] = []\n        for term in state.terms:\n                if term.you_said: visited_terms.append(term)\n        if not visited_terms:\n                return Page(state, [\n                        "You haven\'t studied any terms!",\n                        Button("Return home", index)\n                ])\n\n        term_result_boxes: list[Div] = []\n        results = 0\n        for term in visited_terms:\n                result_box, result = term_result_box(term)\n                term_result_boxes.append(result_box)\n                results += result\n        \n        return Page(state, [\n                f"Result: {results / len(visited_terms) * 100 :.4}%",\n                *term_result_boxes,\n                Button("Return home", index),\n                Button("⟳ Reset Progress and Return home ⟳", reset)\n        ])\n\ndef term_result_box(term: Term) -> tuple[Div, bool]:\n        result = term.definition == term.you_said\n        if result: color = "green"\n        else:      color = "red"\n        return Div(\n                f"Term: {term.term}", LineBreak(),\n                "You said: ", Text(term.you_said, style=f"color: {color}"), LineBreak(),\n                f"Correct: {term.definition}", LineBreak(), LineBreak()\n        ), result\n\n@route\ndef reset(state: State) -> Page:\n        for term in state.terms:\n                term.you_said = ""\n        return index(state)\n\nprint(__version__)\n\ndeploy_site()\n\nget_main_server().configuration.cdn_skulpt = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt.js"\nget_main_server().configuration.cdn_skulpt_std = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt-stdlib.js"\nget_main_server().configuration.cdn_skulpt_drafter = "https://codebodger.github.io/drafter/cdn/skulpt/skulpt-drafter.js"\nget_main_server().configuration.cdn_drafter_setup = "https://codebodger.github.io/drafter/cdn/skulpt/drafter-setup.js"\n\nv = __version__.split(".")\n\nif int(v[0]) == 2 and int(v[1]) == 0:\n        start_server(State(list[Term]()))\n';

            function compilePython() {
                for (let fileName in pythonSource) {
                    let internalName = fileName.replace(/\.py$/, ".js");
                    let contents = pythonSource[fileName];
                    let co = Sk.compile(contents, `src/student/${fileName}`, 'exec', true, true);
                    Sk.builtinFiles.files[`src/student/${internalName}`] = `${co.code}\nvar $builtinmodule = ${co.funcname};`;
                }
            }

            Sk.output = console.log;
        </script>
    </head>

    <body>
        <div id="website">
            Loading...
        </div>
        <script src="https://codebodger.github.io/drafter/cdn/skulpt/drafter-setup.js" type="text/javascript"></script>
    </body>
</html>
